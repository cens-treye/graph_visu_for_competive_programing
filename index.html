<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>競技プログラミング用グラフ視覚化ツール</title>
    <!-- vis-networkライブラリの読み込み -->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script type="text/javascript" src="script.js"></script>
    <link href="dist.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📐</text></svg>">
</head>

<body class="p-4 md:p-6">

    <div class="flex justify-between items-center mb-4">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">競技プログラミング用グラフ視覚化ツール</h1>
        <button id="help-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">
            使い方
        </button>
    </div>

    <!-- コントロールパネル -->
    <div class="controls bg-white p-4 rounded-xl shadow-md mb-4 flex flex-wrap gap-4 items-center justify-start">
        <div class="flex items-center gap-2">
            <button id="import-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">インポート</button>
            <button id="export-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">エクスポート</button>
        </div>
        <div class="flex items-center gap-2">
            <label for="import-type" class="text-sm font-medium text-gray-700">入力形式:</label>
            <select id="import-type" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                <option value="edge-list">Edge List</option>
                <option value="adjacency-list">Adjacency List</option>
                <option value="adjacency-matrix">Adjacency Matrix</option>
            </select>
        </div>
        <div class="flex items-center gap-2">
            <label for="graph-type" class="text-sm font-medium text-gray-700">グラフ種類:</label>
            <select id="graph-type" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                <option value="normal">Normal</option>
                <option value="tree">Tree</option>
            </select>
        </div>
        <div id="root-control" class="flex items-center gap-2 hidden">
            <label for="root-input" class="text-sm font-medium text-gray-700">Root:</label>
            <input type="number" id="root-input" value="0" min="-1" class="w-20 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
            <button id="set-root-btn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-3 rounded-lg shadow transition-colors text-sm">適用</button>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex items-center">
                <input id="directed-checkbox" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                <label for="directed-checkbox" class="ml-2 block text-sm text-gray-900">Directed</label>
            </div>
            <div class="flex items-center">
                <input id="weighted-checkbox" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                <label for="weighted-checkbox" class="ml-2 block text-sm text-gray-900">Weighted</label>
            </div>
        </div>
        <button id="indexing-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">0-indexed</button>
        <button id="reset-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">リセット</button>
        <button id="add-node-btn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">頂点追加</button>
        <div class="flex items-center gap-2">
            <button id="gen-btn" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-colors">ランダムに生成</button>
            <label for="num-nodes" class="text-sm font-medium text-gray-700">頂点数:</label>
            <input type="number" id="num-nodes" value="5" min="1" class="w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
            <label for="num-edges" class="text-sm font-medium text-gray-700">辺数:</label>
            <input type="number" id="num-edges" value="5" min="0" class="w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
        </div>
    </div>

    <!-- メインエリア -->
    <div class="flex-container flex flex-col md:flex-row gap-4">
        <textarea id="io-textarea" class="w-full md:w-1/3 h-64 md:h-auto p-3 border border-gray-300 rounded-lg shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 font-mono" placeholder="ここにグラフ情報を入力・出力..."></textarea>
        <div class="network-container bg-white border border-gray-200 rounded-xl shadow-md overflow-hidden">
            <div id="mynetwork"></div>
        </div>
    </div>

    <!-- 右クリックメニュー (Node) -->
    <div id="node-context-menu" class="context-menu">
        <div class="context-menu-item" id="add-edge-menu-btn">この頂点から辺を追加</div>
        <div class="context-menu-item delete" id="delete-node-menu-btn">この頂点を削除</div>
    </div>

    <!-- 右クリックメニュー (Edge) -->
    <div id="edge-context-menu" class="context-menu">
        <div class="context-menu-item" id="change-weight-menu-btn">重みを変更</div>
        <div class="context-menu-item" id="reverse-edge-menu-btn">向きを逆転</div>
        <div class="context-menu-item delete" id="delete-edge-menu-btn">この辺を削除</div>
    </div>

    <!-- 使い方モーダル -->
    <div id="help-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900">ツールの使い方</h3>
                <div class="mt-2 px-7 py-3 text-left text-sm text-gray-600">
                    <p class="font-bold my-2">基本操作:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li><b>頂点の移動:</b> 頂点をドラッグして移動できます。</li>
                        <li><b>頂点の追加:</b> 右上の「頂点追加」ボタンで新しい頂点を追加します。</li>
                        <li><b>右クリック:</b> 頂点や辺を右クリックすると、編集メニューが表示されます。</li>
                        <li><b>ズーム:</b> マウスホイールで拡大・縮小ができます。</li>
                    </ul>
                    <p class="font-bold my-2 mt-4">インポート:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>テキストエリアにグラフ情報を入力し、「インポート」ボタンを押してください。</li>
                        <li><b>Edge List:</b> 1行目に `N M` (N:頂点数, M:辺数)。2行目以降に辺 `u v (w)` を入力。</li>
                        <li><b>Adjacency List:</b> 1行目に `N`。2行目以降、各行に頂点 `i` の隣接頂点をスペース区切りで入力。</li>
                        <li><b>Adjacency Matrix:</b> 1行目に `N`。2行目以降、N×Nの隣接行列を入力。</li>
                        <li>各種チェックボックスやボタンで、有向/重み付き/0-or-1-indexedを設定してからインポートしてください。</li>
                    </ul>
                    <p class="font-bold my-2 mt-4">エクスポート:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>現在のグラフ情報がEdge List形式でテキストエリアに出力されます。</li>
                    </ul>
                    <p class="font-bold my-2 mt-4">Treeモード:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>グラフ種類で「Tree」を選択すると有効になります。</li>
                        <li>Rootの頂点番号を指定して「適用」すると、根付き木として描画されます。</li>
                        <li>Rootは赤色、その他の頂点はRootからの距離に応じて色が変わります。</li>
                    </ul>
                </div>
                <div class="items-center px-4 py-3">
                    <button id="close-help-modal" class="px-4 py-2 bg-blue-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300">
                        閉じる
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>
